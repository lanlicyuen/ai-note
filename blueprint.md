# AiNote 应用蓝图

## 1. 应用概述

**AiNote** 是一个现代、美观的笔记应用，旨在提供一个简洁、高效的笔记记录体验。它完全支持 Markdown 格式。**（注意：AI 文本润色功能由于构建问题被临时禁用）**。应用遵循 Material Design 3 设计原则，拥有一个响应式布局，并支持用户自由选择浅色、深色或系统默认主题。

## 2. 已实现功能与设计

### 设计与主题
*   **Material Design 3**: 应用整体 UI/UX 遵循最新的 Material 3 指南。
*   **响应式布局**: 使用 `flutter_staggered_grid_view` 创建了一个瀑布流布局，确保在不同尺寸的屏幕上都有良好的视觉效果。
*   **主题管理 (Provider)**:
    *   在 `AppSettings` 提供程序中实现了完善的主题管理逻辑。
    *   支持**浅色**、**深色**和**系统默认**三种主题模式。
    *   用户可在专门的设置页面中进行选择。
*   **自定义字体 (Google Fonts)**:
    *   标题和正文统一使用 `Lato` 字体，保证了视觉一致性和优良的可读性。
*   **视觉风格**:
    *   应用包含精心设计的**浅色**和**深色**两个主题。
    *   卡片式笔记布局，带有圆角和阴影，营造出层次感。
    *   统一且协调的颜色方案，为用户带来舒适的视觉体验。

### 核心功能
*   **完整的笔记 CRUD (创建/读取/更新/删除) 功能**:
    *   **创建**: 用户可以通过悬浮按钮进入 `NoteEditorScreen` 创建新笔记。
    *   **读取**: 主屏幕以瀑布流网格的形式展示所有未归档的笔记。点击笔记卡片可进入编辑器查看和修改。
    *   **更新**: 在 `NoteEditorScreen` 中修改笔记的标题或内容后，点击保存按钮即可更新。编辑器会智能处理“创建”和“更新”两种模式。
    *   **删除与撤销**: 在主屏幕通过滑动笔记卡片可将其删除，删除后会弹出 `SnackBar` 提供“撤销”选项，防止误操作。
*   **Markdown 支持**:
    *   笔记编辑器 (`NoteEditorScreen`) 支持 Markdown 语法输入。
    *   提供预览模式，使用 `flutter_markdown_plus` 精美地渲染 Markdown 内容。
*   **文件夹系统**:
    *   用户可以创建带有自定义颜色和名称的文件夹。
    *   通过拖拽或菜单操作，可以将笔记轻松移入不同文件夹。
*   **笔记归档**:
    *   用户可以归档笔记，归档后的笔记会从主列表隐藏，并显示在专门的“归档”页面。
*   **设置页面**:
    *   提供一个独立的设置页面，用于统一管理应用的所有偏好设置。
    *   用户可以在此页面切换主题。

### AI 智能功能 (临时禁用)
*   **~~集成 Gemini AI~~**:
    *   ~~使用 **`firebase_ai`** 包安全、高效地集成了 Google的 Gemini 模型。~~
    *   ~~在笔记编辑器中提供“AI 润色”功能，用户点击按钮即可自动优化和美化当前笔记内容。~~
*   **~~自定义 AI 指令~~**:
    *   ~~用户可以在设置页面中修改用于 AI 润色的系统提示（Custom Prompt），以满足个性化的文本风格需求。~~

### 状态管理与数据持久化
*   **Provider 状态管理**:
    *   **`NoteProvider`**: 负责管理所有笔记、文件夹的创建、更新、删除和状态变更。
    *   **`AppSettings`**: 负责管理应用的主题模式和 AI 相关设置。
*   **本地数据持久化**:
    *   使用 **`shared_preferences`** 在设备本地保存用户的主题偏好设置。

### 项目结构与品牌
*   **品牌与标识**:
    *   为应用设计了自定义图标，并配置了原生启动画面和正确的应用名称/包名。
*   **依赖管理**: `pubspec.yaml` 文件中清晰地组织了应用的各项依赖。

## 3. 未来计划

*   **修复并重新启用 AI 功能**: 解决当前的构建问题，恢复 Gemini AI 的文本润色功能。
*   **数据库集成**:
    *   使用本地数据库（如 SQLite 或 Hive）或云数据库（如 Firebase Firestore）来替代当前的内存数据存储，实现真正的持久化和跨会话数据保存。
*   **用户认证**:
    *   添加用户登录和注册功能（如 Firebase Authentication），为未来的多端数据同步打下基础。
*   **多端同步**:
    *   在实现用户认证和云数据库后，让用户的笔记和设置可以在不同设备间无缝同步。
